var bifs="vendors = moz webkit o ms official\n\n// stringify the given arg\n\n-string(arg)\n  type(arg) + ' ' + arg\n\n// require a color\n\nrequire-color(color)\n  unless color is a 'color' \n    error('RGB or HSL value expected, got a ' + -string(color))\n\n// require a unit\n\nrequire-unit(n)\n  unless n is a 'unit'\n    error('unit expected, got a ' + -string(n))\n\n// require a string\n\nrequire-string(str)\n  unless str is a 'string' or str is a 'ident'\n    error('string expected, got a ' + -string(str))\n\n// apply js Math function\n\nmath(n, fn) \n  require-unit(n)\n  require-string(fn)\n  -math(n, fn)\n\n// adjust the given color's property by amount\n\nadjust(color, prop, amount)\n  require-color(color)\n  require-string(prop)\n  require-unit(amount)\n  -adjust(color, prop, amount)\n\n// Math functions\n\nabs(n) { math(n, 'abs') }\nceil(n) { math(n, 'ceil') }\nfloor(n) { math(n, 'floor') }\nround(n) { math(n, 'round') }\nsin(n) { math(n, 'sin') }\ncos(n) { math(n, 'cos') }\nmin(a, b) { a < b ? a : b }\nmax(a, b) { a > b ? a : b }\nPI = -math-prop('PI')\n\n// return the sum of the given numbers\n\nsum(nums)\n  sum = 0\n  sum += n for n in nums\n\n// return the average of the given numbers\n\navg(nums)\n  sum(nums) / length(nums)\n\n// color components\n\nalpha(color) { component(hsl(color), 'alpha') }\nhue(color) { component(hsl(color), 'hue') }\nsaturation(color) { component(hsl(color), 'saturation') }\nlightness(color) { component(hsl(color), 'lightness') }\n\n// check if n is an odd number\n\nodd(n)\n  1 == n % 2\n\n// check if n is an even number\n\neven(n)\n  0 == n % 2\n\n// check if color is light\n\nlight(color)\n  lightness(color) >= 50%\n\n// check if color is dark\n\ndark(color)\n  lightness(color) < 50%\n\n// desaturate color by amount\n\ndesaturate(color, amount)\n  adjust(color, 'saturation', - amount)\n\n// saturate color by amount\n\nsaturate(color, amount)\n  adjust(color, 'saturation', amount)\n\n// darken by the given amount\n\ndarken(color, amount)\n  adjust(color, 'lightness', - amount)\n\n// lighten by the given amount\n\nlighten(color, amount)\n  adjust(color, 'lightness', amount)\n\n// decerase opacity by amount\n\nfade-out(color, amount)\n  color - rgba(black, amount)\n\n// increase opacity by amount\n\nfade-in(color, amount)\n  color + rgba(black, amount)\n\n// return the last value in the given expr\n\nlast(expr)\n  expr[length(expr) - 1]\n\n// join values with the given delimiter\n\njoin(delim, vals...)\n  buf = ''\n  vals = vals[0] if length(vals) == 1\n  for val, i in vals\n    buf += i ? delim + val : val\n",stylus=function(){function o(t){var e=o.resolve(t),n=o.modules[e];if(!n)throw new Error('failed to require "'+t+'"');return n.exports||(n.exports={},n.call(n.exports,n,n.exports,o.relative(e))),n.exports}return o.modules={},o.resolve=function(t){var e=t,n=t+".js",i=t+"/index.js";return o.modules[n]&&n||o.modules[i]&&i||e},o.register=function(t,e){o.modules[t]=e},o.relative=function(s){return function(t){if("."!=t[0])return o(t);var e=s.split("/"),n=t.split("/");e.pop();for(var i=0;i<n.length;i++){var r=n[i];".."==r?e.pop():"."!=r&&e.push(r)}return o(e.join("/"))}},o.register("path.js",function(t,p,e){var i=/^([\s\S]+\/(?!$)|\/)?((?:[\s\S]+?)?(\.[^.]*)?)$/;p.normalize=function(t){var e="/"===t.charAt(0),n="/"===t.slice(-1);return!(t=function(t,e){for(var n=0,i=t.length-1;0<=i;i--){var r=t[i];"."==r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}(t.split("/").filter(function(t){return!!t}),!e).join("/"))&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t},p.join=function(){var t=Array.prototype.slice.call(arguments,0);return p.normalize(t.filter(function(t,e){return t&&"string"==typeof t}).join("/"))},p.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;0<=n&&""===t[n];n--);return n<e?[]:t.slice(e,n-e+1)}t=p.resolve(t).substr(1),e=p.resolve(e).substr(1);for(var i=n(t.split("/")),r=n(e.split("/")),s=Math.min(i.length,r.length),o=s,a=0;a<s;a++)if(i[a]!==r[a]){o=a;break}var h=[];for(a=o;a<i.length;a++)h.push("..");return(h=h.concat(r.slice(o))).join("/")},p.dirname=function(t){var e=i.exec(t)[1]||"";return e?1===e.length?e:e.substring(0,e.length-1):"."},p.basename=function(t,e){var n=i.exec(t)[2]||"";return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},p.extname=function(t){return i.exec(t)[3]||""}}),o.register("colors.js",function(t,e,n){t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]}}),o.register("errors.js",function(t,e,n){function i(t){this.name="ParseError",this.message=t,Error.captureStackTrace(this,i)}function r(t){this.name="SyntaxError",this.message=t,Error.captureStackTrace(this,i)}e.ParseError=i,(e.SyntaxError=r).prototype.__proto__=Error.prototype,i.prototype.__proto__=Error.prototype,r.prototype.__proto__=Error.prototype}),o.register("functions/index.js",function(t,r,e){var o=e("../visitor/compiler"),a=e("../nodes"),h=e("../utils"),i=e("./image"),s={red:"r",green:"g",blue:"b",alpha:"a",hue:"h",saturation:"s",lightness:"l"},p={hue:"deg",saturation:"%",lightness:"%"},c={red:"rgba",blue:"rgba",green:"rgba",alpha:"rgba",hue:"hsla",saturation:"hsla",lightness:"hsla"};r.hsla=function(t,e,n,i){switch(arguments.length){case 1:return h.assertColor(t),t.hsla;default:return h.assertType(t,"unit","hue"),h.assertType(e,"unit","saturation"),h.assertType(n,"unit","lightness"),h.assertType(i,"unit","alpha"),new a.HSLA(t.val,e.val,n.val,i.val)}},r.hsl=function(t,e,n){return 1==arguments.length?(h.assertColor(t,"color"),t.hsla):r.hsla(t,e,n,new a.Unit(1))},r.type=r.typeof=r["type-of"]=function(t){h.assertPresent(t,"expression");var e=t.nodeName;return new a.String(e)},r.component=function(t,e){h.assertColor(t,"color"),h.assertString(e,"name");e=e.string;var n=p[e],i=c[e];if(!(e=s[e]))throw new Error('invalid color component "'+e+'"');return new a.Unit(t[i][e],n)},r.red=function(t){return r.component(t,new a.String("red"))},r.green=function(t){return r.component(t,new a.String("green"))},r.blue=function(t){return r.component(t,new a.String("blue"))},r.rgba=function(t,e,n,i){switch(arguments.length){case 1:h.assertColor(t);var r=t.rgba;return new a.RGBA(r.r,r.g,r.b,r.a);case 2:h.assertColor(t);r=t.rgba;return h.assertType(e,"unit","alpha"),new a.RGBA(r.r,r.g,r.b,e.val);default:return h.assertType(t,"unit","red"),h.assertType(e,"unit","green"),h.assertType(n,"unit","blue"),h.assertType(i,"unit","alpha"),new a.RGBA(t.val,e.val,n.val,i.val)}},r.rgb=function(t,e,n){switch(arguments.length){case 1:h.assertColor(t);var i=t.rgba;return new a.RGBA(i.r,i.g,i.b,1);default:return r.rgba(t,e,n,new a.Unit(1))}},r.unquote=function(t){return h.assertString(t,"string"),new a.Literal(t.string)},r.unit=function(t,e){return h.assertType(t,"unit","unit"),e?(h.assertString(e,"type"),new a.Unit(t.val,e.string)):new a.String(t.type||"")},r.lookup=function(t){h.assertType(t,"string","name");var e=this.lookup(t.val);return e?this.visit(e):a.nil},r.operate=function(t,e,n){return h.assertType(t,"string","op"),h.assertPresent(e,"left"),h.assertPresent(n,"right"),e.operate(t.val,n)},r.match=function(t,e){h.assertType(t,"string","pattern"),h.assertString(e,"val");var n=new RegExp(t.val);return a.Boolean(n.test(e.string))},(r.length=function(t){return t?t.nodes?new a.Unit(h.unwrap(t).nodes.length):new a.Unit(1):new a.Unit(0)}).raw=!0,(r.p=function(t){return t=h.unwrap(t),console.log("[90minspect:[0m undefined",t.toString().replace(/^\(|\)$/g,"")),a.nil}).raw=!0,r.error=function(t){throw h.assertType(t,"string","msg"),new Error(t.val)},r.warn=function(t){return h.assertType(t,"string","msg"),console.warn("Warning: undefined",t.val),a.nil},r.trace=function(){return console.log(this.stack),a.nil},(r.push=r.append=function(t){t=h.unwrap(t);for(var e=1,n=arguments.length;e<n;++e)t.nodes.push(h.unwrap(arguments[e]));return new a.Unit(t.nodes.length)}).raw=!0,(r.unshift=r.prepend=function(t){t=h.unwrap(t);for(var e=1,n=arguments.length;e<n;++e)t.nodes.unshift(h.unwrap(arguments[e]));return new a.Unit(t.nodes.length)}).raw=!0,(r.s=function(t){t=h.unwrap(t).nodes[0],h.assertString(t);var i=this,e=t.string,r=arguments,s=1;return e=e.replace(/%(s|d)/g,function(t,e){var n=r[s++]||a.nil;switch(e){case"s":return new o(n,i.options).compile();case"d":if("unit"!=(n=h.unwrap(n).first).nodeName)throw new Error("NaN requires a unit");return n.val}}),new a.Literal(e)}).raw=!0,(r["opposite-position"]=function(t){var n=new a.Expression;return h.unwrap(t).nodes.forEach(function(t,e){h.assertString(t,"position "+e),t=function(){switch(t.string){case"top":return"bottom";case"bottom":return"top";case"left":return"right";case"right":return"left";default:throw new Error("invalid position "+t)}}(),n.push(new a.Literal(t))}),n}).raw=!0,r["image-size"]=function(t){h.assertType(t,"string","img"),(t=new i(this,t.string)).open();var e=t.size();t.close();var n=new a.Expression;return n.push(new a.Unit(e[0],"px")),n.push(new a.Unit(e[1],"px")),n},r["-math"]=function(t,e){return new a.Unit(Math[e.string](t.val),t.type)},r["-math-prop"]=function(t){return new a.Unit(Math[t.string])},r.js=function(t){return h.assertString(t,"str"),new a.JSLiteral(t.val)},r["-adjust"]=function(t,e,n){var i=t.hsla.clone();if(!(e={hue:"h",saturation:"s",lightness:"l"}[e.string]))throw new Error("invalid adjustment property");var r=n.val;return"%"==n.type&&(r="l"==e&&0<r?(100-i[e])*r/100:i[e]*(r/100)),i[e]+=r,i.rgba},(r.clone=function(t){return h.assertPresent(t,"expr"),t.clone()}).raw=!0,(r["add-property"]=function(t,e){h.assertType(t,"expression","name"),t=h.unwrap(t).first,h.assertString(t,"name"),h.assertType(e,"expression","expr");var n=new a.Property([t],e),i=this.closestBlock,r=i.nodes.length,s=i.nodes.slice(0,i.index),o=i.nodes.slice(i.index++,r);return s.push(n),i.nodes=s.concat(o),n}).raw=!0}),o.register("functions/image.js",function(t,e,n){var i=n("../utils"),r=(n("../nodes"),t.exports=function(t,e){if(this.ctx=t,this.path=i.lookup(e,t.paths),!this.path)throw new Error("failed to locate file "+e)});r.prototype.open=function(){this.fd=fs.openSync(this.path,"r")},r.prototype.close=function(){this.fd&&fs.closeSync(this.fd)},r.prototype.type=function(){var t,e=new Buffer(4);return fs.readSync(this.fd,e,0,4,0),71==e[0]&&73==e[1]&&70==e[2]?t="gif":80==e[1]&&78==e[2]&&71==e[3]?t="png":255==e[0]&&216==e[1]&&(t="jpeg"),t},r.prototype.size=function(){function t(t){return t[1]<<8|t[0]}function e(t){return t[0]<<24|t[1]<<16|t[2]<<8|t[3]}var n,i;switch(this.type()){case"jpeg":throw new Error("image-size() jpeg support not yet implemented");case"png":var r=new Buffer(8);fs.readSync(this.fd,r,0,8,16),n=e(r),i=e(r.slice(4,8));break;case"gif":r=new Buffer(4);fs.readSync(this.fd,r,0,4,6),n=t(r),i=t(r.slice(2,4))}if("number"!=typeof n)throw new Error('failed to find width of "'+this.path+'"');if("number"!=typeof i)throw new Error('failed to find height of "'+this.path+'"');return[n,i]}}),o.register("functions/url.js",function(t,e,n){var p=n("../visitor/compiler"),c=n("../nodes"),u=n("../path").extname,l=n("../utils"),f={".gif":"image/gif",".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".svg":"image/svg+xml"};t.exports=function(t){function e(t){var e=new p(t);e.isURL=!0;t=t.nodes.map(function(t){return e.visit(t)}).join(""),t=parse(t);var n,i=u(t.pathname),r=f[i],s=new c.Literal('url("'+t.href+'")'),o=h.concat(this.paths);return r?t.protocol?s:(found=l.lookup(t.pathname,o),found?(n=fs.readFileSync(found)).length>a?s:new c.Literal('url("data:'+r+";base64,"+n.toString("base64")+'")'):s):s}var a=(t=t||{}).limit||3e4,h=t.paths||[];return e.raw=!0,e}}),o.register("lexer.js",function(t,e,n){var a=n("./token"),h=n("./nodes"),r=n("./errors"),i={and:"&&",or:"||",is:"==",isnt:"!=","is not":"!=",":=":"?="},s=["em","ex","px","mm","cm","in","pt","pc","deg","rad","grad","ms","s","Hz","kHz","rem","%"].join("|"),o=new RegExp("^(-)?(\\d+\\.\\d+|\\d+|\\.\\d+)("+s+")? *");(t.exports=function(t,e){e=e||{},this.str=t.replace(/\r\n?/g,"\n"),this.stash=[],this.indentStack=[],this.indentRe=null,this.lineno=1}).prototype={inspect:function(){for(var t,e=this.str,n=[];"eos"!=(t=this.next()).type;)n.push(t.inspect());return this.str=e,this.prevIndents=0,n.concat(t.inspect()).join("\n")},lookahead:function(t){for(var e=t-this.stash.length;0<e--;)this.stash.push(this.advance());return this.stash[--t]},skip:function(t){this.str=this.str.substr(Array.isArray(t)?t[0].length:t)},next:function(){var t=this.stashed()||this.advance();switch(t.type){case"newline":case"indent":++this.lineno;break;case"outdent":"outdent"!=this.prev.type&&++this.lineno}return(this.prev=t).lineno=this.lineno,t},advance:function(){return this.eos()||this.nil()||this.sep()||this.keyword()||this.urlchars()||this.atrule()||this.scope()||this.media()||this.comment()||this.newline()||this.escaped()||this.important()||this.literal()||this.fun()||this.brace()||this.paren()||this.color()||this.string()||this.unit()||this.namedop()||this.boolean()||this.ident()||this.op()||this.space()||this.selector()},peek:function(){return this.lookahead(1)},stashed:function(){return this.stash.shift()},eos:function(){if(!this.str.length)return this.indentStack.length?(this.indentStack.shift(),new a("outdent")):new a("eos")},urlchars:function(){var t;if(this.isURL)return(t=/^[\/:@.;?&=*!,<>#%0-9]+/.exec(this.str))?(this.skip(t),new a("literal",new h.Literal(t[0]))):void 0},sep:function(){var t;if(t=/^; */.exec(this.str))return this.skip(t),new a(";")},space:function(){var t;if(t=/^( +)/.exec(this.str))return this.skip(t),new a("space")},escaped:function(){var t;if(t=/^\\(.) */.exec(this.str)){var e=t[1];return this.skip(t),new a("ident",new h.Literal(e))}},literal:function(){var t;if(t=/^@css *\{/.exec(this.str)){this.skip(t);for(var e,n=1,i="";e=this.str[0];){switch(this.str=this.str.substr(1),e){case"{":++n;break;case"}":--n}if(i+=e,!n)break}return i=i.replace(/\s*}$/,""),new a("literal",new h.Literal(i))}},important:function(){var t;if(t=/^!important */.exec(this.str))return this.skip(t),new a("ident",new h.Literal("!important"))},brace:function(){var t;if(t=/^([{}])/.exec(this.str)){this.skip(1);var e=t[1];return new a(e,e)}},paren:function(){var t;if(t=/^([()]) */.exec(this.str)){var e=t[1];return this.skip(t),")"==e&&(this.isURL=!1),new a(e,e)}},nil:function(){var t;if(t=/^(null)\b */.exec(this.str))return this.skip(t),new a("null",h.nil)},keyword:function(){var t;if(t=/^(return|if|else|unless|for|in)\b */.exec(this.str)){var e=t[1];return this.skip(t),new a(e,e)}},namedop:function(){var t;if(t=/^(not|and|or|is a|is defined|isnt|is not|is)\b( *)/.exec(this.str)){var e=t[1];this.skip(t);var n=new a(e=i[e]||e,e);return n.space=t[2],n}},op:function(){var t;if(t=/^([.]{2,3}|&&|\|\||[!<>=?:]=|\*\*|[-+*\/%]=?|[,=?:!~<>&\[\]])( *)/.exec(this.str)){var e=t[1];this.skip(t);var n=new a(e=i[e]||e,e);return n.space=t[2],n}},media:function(){var t;if(t=/^@media *([^\/{\n]+)/.exec(this.str))return this.skip(t),new a("media",t[1].trim())},scope:function(){var t;if(t=/^@scope *([^\/{\n]+)/.exec(this.str))return this.skip(t),new a("scope",t[1].trim())},atrule:function(){var t;if(t=/^@(import|(?:-(\w+)-)?keyframes|charset|font-face|page) */.exec(this.str)){this.skip(t);var e=t[2],n=t[1];return e&&(n="keyframes"),new a(n,e)}},comment:function(){if("/"==this.str[0]&&"/"==this.str[1])return-1==(t=this.str.indexOf("\n"))&&(t=this.str.length),this.skip(t),this.advance();if("/"==this.str[0]&&"*"==this.str[1]){var t;-1==(t=this.str.indexOf("*/"))&&(t=this.str.length);var e=this.str.substr(0,t+2),n=e.split("\n").length-1,i=!0;return this.lineno+=n,this.skip(t+2),"!"==e[2]&&(e=e.replace("*!","*"),i=!1),new a("comment",new h.Comment(e,i))}},boolean:function(){var t;if(t=/^(true|false)\b( *)/.exec(this.str)){var e=h.Boolean("true"==t[1]);this.skip(t);var n=new a("boolean",e);return n.space=t[2],n}},fun:function(){var t;if(t=/^(-?[a-zA-Z$][-\w\d$]*)\(( *)/.exec(this.str)){var e=t[1];this.skip(t),this.isURL="url"==e;var n=new a("function",new h.Ident(e));return n.space=t[2],n}},ident:function(){var t;if(t=/^(@)?(-?[_a-zA-Z$][-\w\d$]*)/.exec(this.str)){var e=t[1],n=t[2],i=new h.Ident(n);return this.skip(t),i.property=!!e,new a("ident",i)}},newline:function(){var t,e;if(this.indentRe?t=this.indentRe.exec(this.str):((t=(e=/^\n([\t]*) */).exec(this.str))&&!t[1].length&&(t=(e=/^\n( *)/).exec(this.str)),t&&t[1].length&&(this.indentRe=e)),t){var n,i=t[1].length;if(this.skip(t)," "===this.str[0]||"\t"===this.str[0])throw new r.SyntaxError("Invalid indentation. You can use tabs or spaces to indent, but not both.");if(this.isVariable=!1,"\n"==this.str[0])return++this.lineno,this.advance();if(this.indentStack.length&&i<this.indentStack[0]){for(;this.indentStack.length&&this.indentStack[0]>i;)this.stash.push(new a("outdent")),this.indentStack.shift();n=this.stash.pop()}else i&&i!=this.indentStack[0]?(this.indentStack.unshift(i),n=new a("indent")):n=new a("newline");return n}},unit:function(){var t;if(t=o.exec(this.str)){this.skip(t);var e=parseFloat(t[2]);"-"==t[1]&&(e=-e);var n=new h.Unit(e,t[3]);return new a("unit",n)}},string:function(){var t;if(t=/^("[^"]*"|'[^']*') */.exec(this.str)){var e=t[1];return this.skip(t),e=e.slice(1,-1).replace(/\\n/g,"\n"),new a("string",new h.String(e))}},color:function(){return this.rrggbbaa()||this.rrggbb()||this.rgba()||this.rgb()},rgb:function(){var t;if(t=/^#([a-fA-F0-9]{3}) */.exec(this.str)){this.skip(t);var e=t[1],n=parseInt(e[0]+e[0],16),i=parseInt(e[1]+e[1],16),r=parseInt(e[2]+e[2],16),s=new h.RGBA(n,i,r,1);return s.raw=t[0],new a("color",s)}},rgba:function(){var t;if(t=/^#([a-fA-F0-9]{4}) */.exec(this.str)){this.skip(t);var e=t[1],n=parseInt(e[0]+e[0],16),i=parseInt(e[1]+e[1],16),r=parseInt(e[2]+e[2],16),s=parseInt(e[3]+e[3],16),o=new h.RGBA(n,i,r,s/255);return o.raw=t[0],new a("color",o)}},rrggbb:function(){var t;if(t=/^#([a-fA-F0-9]{6}) */.exec(this.str)){this.skip(t);var e=t[1],n=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16),s=new h.RGBA(n,i,r,1);return s.raw=t[0],new a("color",s)}},rrggbbaa:function(){var t;if(t=/^#([a-fA-F0-9]{8}) */.exec(this.str)){this.skip(t);var e=t[1],n=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16),s=parseInt(e.substr(6,2),16),o=new h.RGBA(n,i,r,s/255);return o.raw=t[0],new a("color",o)}},selector:function(){var t;if(t=/^[^{\n,]+/.exec(this.str)){var e=t[0];return this.skip(t),new a("selector",e)}}}}),o.register("nodes/arguments.js",function(t,e,n){n("./node");var i=n("../nodes"),r=(n("../utils"),t.exports=function(){i.Expression.call(this),this.map={}});r.prototype.__proto__=i.Expression.prototype,r.fromExpression=function(t){var e=new r,n=t.nodes.length;e.lineno=t.lineno,e.isList=t.isList;for(var i=0;i<n;++i)e.push(t.nodes[i]);return e},r.prototype.clone=function(){var t=i.Expression.prototype.clone.call(this);return t.map=this.map,t}}),o.register("nodes/binop.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e,n){i.call(this),this.op=t,this.left=e,this.right=n};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=new r(this.op,this.left.clone(),this.right?this.right.clone():null);return t.lineno=this.lineno,t.filename=this.filename,this.val&&(t.val=this.val.clone()),t}}),o.register("nodes/block.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.nodes=[],this.parent=t,this.node=e,this.scope=!0};r.prototype.__proto__=i.prototype,r.prototype.__defineGetter__("hasProperties",function(){for(var t=0,e=this.nodes.length;t<e;++t)if("property"==this.nodes[t].nodeName)return!0}),r.prototype.__defineGetter__("isEmpty",function(){return!this.nodes.length}),r.prototype.clone=function(){var e=new r(this.parent,this.node);return e.lineno=this.lineno,e.filename=this.filename,e.scope=this.scope,this.nodes.forEach(function(t){switch((t=t.clone()).nodeName){case"each":case"group":t.block.parent=e;break;case"ident":"function"==t.val.nodeName&&(t.val.block.parent=e)}e.push(t)}),e},r.prototype.push=function(t){this.nodes.push(t)}}),o.register("nodes/boolean.js",function(t,e,n){var i=n("./node"),r=(n("./index"),t.exports=function t(e){if(i.call(this),!this.nodeName)return new t(e);this.val=!!e});r.prototype.__proto__=i.prototype,r.prototype.toBoolean=function(){return this},r.prototype.__defineGetter__("isTrue",function(){return this.val}),r.prototype.__defineGetter__("isFalse",function(){return!this.val}),r.prototype.negate=function(){return r(!this.val)},r.prototype.inspect=function(){return"[Boolean "+this.val+"]"},r.prototype.toString=function(){return this.val?"true":"false"}}),o.register("nodes/call.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.name=t,this.args=e};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=new r(this.name,this.args.clone());return t.lineno=this.lineno,t.filename=this.filename,t},r.prototype.toString=function(){return this.name+"()"}}),o.register("nodes/charset.js",function(t,e,n){var i=n("./node"),r=(n("./index"),t.exports=function(t){i.call(this),this.val=t});r.prototype.__proto__=i.prototype,r.prototype.toString=function(){return"@charset "+this.val}}),o.register("nodes/comment.js",function(t,e,n){var i=n("./node");(t.exports=function(t,e){i.call(this),this.str=t,this.suppress=e}).prototype.__proto__=i.prototype}),o.register("nodes/each.js",function(t,e,n){var r=n("./node"),i=(n("./index"),t.exports=function(t,e,n,i){r.call(this),this.val=t,this.key=e,this.expr=n,this.block=i});i.prototype.__proto__=r.prototype,i.prototype.clone=function(){var t=new i(this.val,this.key,this.expr.clone(),this.block.clone());return t.lineno=this.lineno,t.filename=this.filename,t}}),o.register("nodes/expression.js",function(t,e,n){var u=n("./node"),l=n("../nodes"),f=n("../utils"),i=t.exports=function(t){u.call(this),this.nodes=[],this.isList=t};i.prototype.__defineGetter__("isEmpty",function(){return!this.nodes.length}),i.prototype.__defineGetter__("first",function(){return this.nodes[0]?this.nodes[0].first:l.nil}),i.prototype.__defineGetter__("hash",function(){return this.nodes.map(function(t){return t.hash}).join("::")}),i.prototype.__proto__=u.prototype,i.prototype.clone=function(){var t=new this.constructor(this.isList);t.preserve=this.preserve,t.lineno=this.lineno,t.filename=this.filename;for(var e=0;e<this.nodes.length;++e)t.push(this.nodes[e].clone());return t},i.prototype.push=function(t){this.nodes.push(t)},i.prototype.operate=function(t,e,n){switch(t){case"[]=":var i=this,r=f.unwrap(e).nodes;n=f.unwrap(n);return r.forEach(function(t){if(p=i.nodes.length,"unit"==t.nodeName){for(var e=t.val;e-- >p;)i.nodes[e]=l.nil;i.nodes[t.val]=n}}),n;case"[]":var s=new l.Expression,o=f.unwrap(this).nodes;return(r=f.unwrap(e).nodes).forEach(function(t){if("unit"==t.nodeName){var e=o[t.val];e&&s.push(e)}}),s.isEmpty?l.nil:f.unwrap(s);case"||":return 1<this.nodes.length?this:this.first.operate(t,e,n)==this.nodes[0]?this:e;case"in":return u.prototype.operate.call(this,t,e);case"!=":return this.operate("==",e,n).negate();case"==":var a,h,p=this.nodes.length;e=e.toExpression();if(p!=e.nodes.length)return l.no;for(var c=0;c<p;++c)if(a=this.nodes[c],h=e.nodes[c],!a.operate(t,h).isTrue)return l.no;return l.yes;default:return this.first.operate(t,e,n)}},i.prototype.toBoolean=function(){for(var t=0,e=this.nodes.length;t<e;++t)if(this.nodes[t].toBoolean().isTrue)return l.yes;return l.no},i.prototype.toString=function(){return"("+this.nodes.map(function(t){return t.toString()}).join(this.isList?", ":" ")+")"}}),o.register("nodes/fontface.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t){i.call(this),this.block=t};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=new r(this.block.clone());return t.lineno=this.lineno,t.filename=this.filename,t},r.prototype.toString=function(){return"@font-face"}}),o.register("nodes/function.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e,n){i.call(this),this.name=t,this.params=e,this.block=n,"function"==typeof e&&(this.fn=e)};r.prototype.__defineGetter__("arity",function(){return this.params.length}),r.prototype.__proto__=i.prototype,r.prototype.__defineGetter__("hash",function(){return"function "+this.name}),r.prototype.clone=function(){if(this.fn)var t=new r(this.name,this.fn);else t=new r(this.name,this.params.clone(),this.block.clone());return t.lineno=this.lineno,t.filename=this.filename,t},r.prototype.toString=function(){return this.fn?this.name+"("+this.fn.toString().match(/^function *\((.*?)\)/).slice(1).join(", ")+")":this.name+"("+this.params.nodes.join(", ")+")"}}),o.register("nodes/group.js",function(t,e,n){var i=n("./node"),r=t.exports=function(){i.call(this),this.nodes=[]};r.prototype.__proto__=i.prototype,r.prototype.push=function(t){this.nodes.push(t)},r.prototype.__defineGetter__("block",function(){return this.nodes[0].block}),r.prototype.__defineSetter__("block",function(t){for(var e=0,n=this.nodes.length;e<n;++e)this.nodes[e].block=t}),r.prototype.clone=function(){var e=new r;return e.lineno=this.lineno,this.nodes.forEach(function(t){e.push(t.clone())}),e.filename=this.filename,e.block=this.block.clone(),e}}),o.register("nodes/hsla.js",function(t,e,n){function s(t){return 0<=(t%=360)?t:360+t}function o(t){return Math.max(0,Math.min(t,100))}var a=n("./node"),i=n("./index"),u=e=t.exports=function(t,e,n,i){var r;a.call(this),this.h=s(t),this.s=o(e),this.l=o(n),this.a=(r=i,Math.max(0,Math.min(r,1))),this.hsla=this};u.prototype.__proto__=a.prototype,u.prototype.toString=function(){return"hsla("+this.h+","+this.s.toFixed(0)+","+this.l.toFixed(0)+","+this.a+")"},u.prototype.clone=function(){var t=new u(this.h,this.s,this.l,this.a);return t.lineno=this.lineno,t.filename=this.filename,t},u.prototype.__defineGetter__("rgba",function(){return i.RGBA.fromHSLA(this)}),u.prototype.__defineGetter__("hash",function(){return this.rgba.toString()}),u.prototype.add=function(t,e,n){return new u(this.h+t,this.s+e,this.l+n,this.a)},u.prototype.sub=function(t,e,n){return this.add(-t,-e,-n)},u.prototype.operate=function(t,e){switch(t){case"==":case"!=":case"<=":case">=":case"<":case">":case"is a":case"||":case"&&":return this.rgba.operate(t,e);default:return this.rgba.operate(t,e).hsla}},e.fromRGBA=function(t){var e,n,i=t.r/255,r=t.g/255,s=t.b/255,o=t.a,a=Math.min(i,r,s),h=Math.max(i,r,s),p=(h+a)/2,c=h-a;switch(h){case a:e=0;break;case i:e=60*(r-s)/c;break;case r:e=60*(s-i)/c+120;break;case s:e=60*(i-r)/c+240}return n=h==a?0:p<.5?c/(2*p):c/(2-2*p),new u(e%=360,n*=100,p*=100,o)},u.prototype.adjustLightness=function(t){return this.l=o(this.l+this.l*(t/100)),this},u.prototype.adjustHue=function(t){return this.h=s(this.h+t),this}}),o.register("nodes/ident.js",function(t,e,n){var r=n("./node"),s=n("./index"),i=t.exports=function(t,e){r.call(this),this.name=t,this.string=t,this.val=e||s.nil};i.prototype.__defineGetter__("isEmpty",function(){return null==this.val}),i.prototype.__defineGetter__("hash",function(){return this.name}),i.prototype.__proto__=r.prototype,i.prototype.clone=function(){var t=new i(this.name,this.val.clone());return t.lineno=this.lineno,t.filename=this.filename,t.property=this.property,t},i.prototype.toString=function(){return this.name},i.prototype.coerce=function(t){switch(t.nodeName){case"ident":case"string":case"literal":return new i(t.string);default:return r.prototype.coerce.call(this,t)}},i.prototype.operate=function(t,e){var n=e.first;switch(t){case"-":if("unit"==n.nodeName){var i=new s.Expression;return n.val=-n.val,i.push(this),i.push(n),i}case"+":return new s.Ident(this.string+this.coerce(n).string)}return r.prototype.operate.call(this,t,e)}}),o.register("nodes/if.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.cond=t,this.elses=[],e&&e.nodeName?this.block=e:this.negate=e};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=this.cond.clone(),e=this.block.clone(),n=new r(t,e);return n.elses=this.elses.map(function(t){return t.clone()}),n.negate=this.negate,n.lineno=this.lineno,n.filename=this.filename,n}}),o.register("nodes/import.js",function(t,e,n){var i=n("./node");(t.exports=function(t){i.call(this),this.path=t}).prototype.__proto__=i.prototype}),o.register("nodes/index.js",function(t,e,n){e.Node=n("./node"),e.Root=n("./root"),e.Null=n("./null"),e.Each=n("./each"),e.If=n("./if"),e.Call=n("./call"),e.Page=n("./page"),e.FontFace=n("./fontface"),e.UnaryOp=n("./unaryop"),e.BinOp=n("./binop"),e.Ternary=n("./ternary"),e.Block=n("./block"),e.Unit=n("./unit"),e.String=n("./string"),e.HSLA=n("./hsla"),e.RGBA=n("./rgba"),e.Ident=n("./ident"),e.Group=n("./group"),e.Literal=n("./literal"),e.JSLiteral=n("./jsliteral"),e.Boolean=n("./boolean"),e.Return=n("./return"),e.Media=n("./media"),e.Params=n("./params"),e.Comment=n("./comment"),e.Keyframes=n("./keyframes"),e.Charset=n("./charset"),e.Import=n("./import"),e.Function=n("./function"),e.Property=n("./property"),e.Selector=n("./selector"),e.Expression=n("./expression"),e.Arguments=n("./arguments"),e.yes=new e.Boolean(!0),e.no=new e.Boolean(!1),e.nil=new e.Null}),o.register("nodes/jsliteral.js",function(t,e,n){var i=n("./node");n("./index");(t.exports=function(t){i.call(this),this.val=t,this.string=t}).prototype.__proto__=i.prototype}),o.register("nodes/keyframes.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.name=t,this.frames=[],this.prefix=e||"official"};r.prototype.__proto__=i.prototype,r.prototype.push=function(t,e){this.frames.push({pos:t,block:e})},r.prototype.clone=function(){var t=new r(this.name);return t.lineno=this.lineno,t.prefix=this.prefix,t.frames=this.frames.map(function(t){return t.block=t.block.clone(),t}),t},r.prototype.toString=function(){return"@keyframes "+this.name}}),o.register("nodes/literal.js",function(t,e,n){var i=n("./node"),r=n("./index"),s=t.exports=function(t){i.call(this),this.val=t,this.string=t};s.prototype.__proto__=i.prototype,s.prototype.__defineGetter__("hash",function(){return this.val}),s.prototype.toString=function(){return this.val},s.prototype.coerce=function(t){switch(t.nodeName){case"ident":case"string":case"literal":return new s(t.string);default:return i.prototype.coerce.call(this,t)}},s.prototype.operate=function(t,e){var n=e.first;switch(t){case"+":return new r.Literal(this.string+this.coerce(n).string);default:return i.prototype.operate.call(this,t,e)}}}),o.register("nodes/media.js",function(t,e,n){var i=n("./node"),r=(n("./index"),t.exports=function(t){i.call(this),this.val=t});r.prototype.__proto__=i.prototype,r.prototype.toString=function(){return"@media "+this.val}}),o.register("nodes/node.js",function(t,e,n){function i(t){this.name="CoercionError",this.message=t,Error.captureStackTrace(this,i)}var r=n("../visitor/evaluator"),p=n("../utils"),c=n("./index"),s=t.exports=function(){this.lineno=c.lineno,Object.defineProperty(this,"filename",{writable:!0,value:c.filename})};s.prototype.__defineGetter__("first",function(){return this}),s.prototype.__defineGetter__("hash",function(){return this.val}),s.prototype.__defineGetter__("nodeName",function(){return this.constructor.name.toLowerCase()}),s.prototype.clone=function(){return this},s.prototype.eval=function(){return new r(this).evaluate()},s.prototype.toBoolean=function(){return c.yes},s.prototype.toExpression=function(){if("expression"==this.nodeName)return this;var t=new c.Expression;return t.push(this),t},s.prototype.shouldCoerce=function(t){switch(t){case"is a":case"in":case"||":case"&&":return!1;default:return!0}},s.prototype.operate=function(t,e){switch(t){case"is a":if("string"==e.nodeName)return c.Boolean(this.nodeName==e.val);throw new Error('"is a" expects a string, got '+e.toString());case"==":return c.Boolean(this.hash==e.hash);case"!=":return c.Boolean(this.hash!=e.hash);case">=":return c.Boolean(this.hash>=e.hash);case"<=":return c.Boolean(this.hash<=e.hash);case">":return c.Boolean(this.hash>e.hash);case"<":return c.Boolean(this.hash<e.hash);case"||":return this.toBoolean().isTrue?this:e;case"in":var n=p.unwrap(e).nodes,i=this.hash;if(!n)throw new Error('"in" given invalid right-hand operand, expecting an expression');for(var r=0,s=n.length;r<s;++r)if(i==n[r].hash)return c.yes;return c.no;case"&&":var o=this.toBoolean(),a=e.toBoolean();return o.isTrue&&a.isTrue?e:o.isFalse?this:e;default:if("[]"==t)var h="cannot perform "+this+"["+e+"]";else h="cannot perform "+this+" "+t+" "+e;throw new Error(h)}},i.prototype.__proto__=Error.prototype,s.prototype.coerce=function(t){if(t.nodeName==this.nodeName)return t;throw new i("cannot coerce "+t+" to "+this.nodeName)}}),o.register("nodes/null.js",function(t,e,n){var i=n("./node"),r=n("./index"),s=t.exports=function(){};s.prototype.__proto__=i.prototype,s.prototype.inspect=s.prototype.toString=function(){return"null"},s.prototype.toBoolean=function(){return r.no},s.prototype.__defineGetter__("isNull",function(){return!0}),s.prototype.__defineGetter__("hash",function(){return null})}),o.register("nodes/page.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.selector=t,this.block=e};r.prototype.__proto__=i.prototype,r.prototype.toString=function(){return"@page "+this.selector}}),o.register("nodes/params.js",function(t,e,n){var i=n("./node"),r=t.exports=function(){i.call(this),this.nodes=[]};r.prototype.__defineGetter__("length",function(){return this.nodes.length}),r.prototype.__proto__=i.prototype,r.prototype.push=function(t){this.nodes.push(t)},r.prototype.clone=function(){var e=new r;return e.lineno=this.lineno,e.filename=this.filename,this.nodes.forEach(function(t){e.push(t.clone())}),e}}),o.register("nodes/property.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.segments=t,this.expr=e};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=new r(this.segments);return t.lineno=this.lineno,t.filename=this.filename,t.segments=this.segments.map(function(t){return t.clone()}),this.expr&&(t.expr=this.expr.clone()),t},r.prototype.toString=function(){return"property("+this.name+", "+this.expr+")"},r.prototype.operate=function(t,e,n){return this.expr.operate(t,e,n)}}),o.register("nodes/return.js",function(t,e,n){var i=n("./node"),r=n("./index"),s=t.exports=function(t){this.expr=t||r.nil};s.prototype.__proto__=i.prototype,s.prototype.clone=function(){var t=new s(this.expr.clone());return t.lineno=this.lineno,t.filename=this.filename,t}}),o.register("nodes/rgba.js",function(t,e,n){function s(t){return Math.max(0,Math.min(t.toFixed(0),255))}var o=n("./node"),i=n("./hsla"),r=n("../functions")["-adjust"],a=n("./index"),u=e=t.exports=function(t,e,n,i){var r;o.call(this),this.r=s(t),this.g=s(e),this.b=s(n),this.a=(r=i,Math.max(0,Math.min(r,1))),this.rgba=this};u.prototype.__proto__=o.prototype,u.withoutClamping=function(t,e,n,i){var r=new u(0,0,0,0);return r.r=t,r.g=e,r.b=n,r.a=i,r},u.prototype.clone=function(){var t=new u(this.r,this.g,this.b,this.a);return t.lineno=this.lineno,t.filename=this.filename,t},u.prototype.toBoolean=function(){return a.yes},u.prototype.__defineGetter__("hsla",function(){return i.fromRGBA(this)}),u.prototype.__defineGetter__("hash",function(){return this.toString()}),u.prototype.add=function(t,e,n,i){return new u(this.r+t,this.g+e,this.b+n,this.a+i)},u.prototype.sub=function(t,e,n,i){return new u(this.r-t,this.g-e,this.b-n,1==i?this.a:this.a-i)},u.prototype.multiply=function(t){return new u(this.r*t,this.g*t,this.b*t,this.a)},u.prototype.divide=function(t){return new u(this.r/t,this.g/t,this.b/t,this.a)},u.prototype.operate=function(t,e){switch(e=e.first,t){case"is a":if("string"==e.nodeName&&"color"==e.string)return a.yes;break;case"+":switch(e.nodeName){case"unit":var n=e.val;switch(e.type){case"%":return r(this,new a.String("lightness"),e);case"deg":return this.hsla.adjustHue(n).rgba;default:return this.add(n,n,n,0)}case"rgba":return this.add(e.r,e.g,e.b,e.a);case"hsla":return this.hsla.add(e.h,e.s,e.l)}break;case"-":switch(e.nodeName){case"unit":n=e.val;switch(e.type){case"%":return r(this,new a.String("lightness"),new a.Unit(-n,"%"));case"deg":return this.hsla.adjustHue(-n).rgba;default:return this.sub(n,n,n,0)}case"rgba":return this.sub(e.r,e.g,e.b,e.a);case"hsla":return this.hsla.sub(e.h,e.s,e.l)}break;case"*":switch(e.nodeName){case"unit":return this.multiply(e.val)}break;case"/":switch(e.nodeName){case"unit":return this.divide(e.val)}}return o.prototype.operate.call(this,t,e)},u.prototype.toString=function(){function t(t){return t<16?"0"+t.toString(16):t.toString(16)}if(1==this.a){var e=t(this.r),n=t(this.g),i=t(this.b);return e[0]==e[1]&&n[0]==n[1]&&i[0]==i[1]?"#"+e[0]+n[0]+i[0]:"#"+e+n+i}return"rgba("+this.r+","+this.g+","+this.b+","+this.a.toFixed(2)+")"},e.fromHSLA=function(t){function e(t){return t<0&&++t,1<t&&--t,6*t<1?a+(o-a)*t*6:2*t<1?o:3*t<2?a+(o-a)*(2/3-t)*6:a}var n=t.h/360,i=t.s/100,r=t.l/100,s=t.a,o=r<=.5?r*(i+1):r+i-r*i,a=2*r-o,h=255*e(n+1/3),p=255*e(n),c=255*e(n-1/3);return new u(h,p,c,s)}}),o.register("nodes/root.js",function(t,e,n){var i=n("./node"),r=t.exports=function(){this.nodes=[]};r.prototype.__proto__=i.prototype,r.prototype.push=function(t){this.nodes.push(t)},r.prototype.toString=function(){return"[Root]"}}),o.register("nodes/selector.js",function(t,e,n){n("./block");var i=n("./node"),r=t.exports=function(t){i.call(this),this.segments=t};r.prototype.__proto__=i.prototype,r.prototype.toString=function(){return this.segments.join("")},r.prototype.clone=function(){var t=new r;return t.lineno=this.lineno,t.filename=this.filename,t.segments=this.segments.map(function(t){return t.clone()}),t}}),o.register("nodes/string.js",function(t,e,n){var r=n("./node"),s=n("../functions").s,o=n("../utils"),a=n("./index"),h=t.exports=function(t){r.call(this),this.val=t,this.string=t};h.prototype.__proto__=r.prototype,h.prototype.toString=function(){return'"'+this.val+'"'},h.prototype.clone=function(){var t=new h(this.val);return t.lineno=this.lineno,t.filename=this.filename,t},h.prototype.toBoolean=function(){return a.Boolean(this.val.length)},h.prototype.coerce=function(t){switch(t.nodeName){case"string":return t;case"expression":return new h(t.nodes.map(function(t){return this.coerce(t).val},this).join(" "));default:return new h(t.toString())}},h.prototype.operate=function(t,e){switch(t){case"%":var n=new a.Expression;n.push(this);var i="expression"==e.nodeName?o.unwrap(e).nodes:[e];return s.apply(null,[n].concat(i));case"+":return new h(this.val+this.coerce(e).val);default:return r.prototype.operate.call(this,t,e)}}}),o.register("nodes/ternary.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e,n){i.call(this),this.cond=t,this.trueExpr=e,this.falseExpr=n};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=new r(this.cond.clone(),this.trueExpr.clone(),this.falseExpr.clone());return t.lineno=this.lineno,t.filename=this.filename,t}}),o.register("nodes/unaryop.js",function(t,e,n){var i=n("./node"),r=t.exports=function(t,e){i.call(this),this.op=t,this.expr=e};r.prototype.__proto__=i.prototype,r.prototype.clone=function(){var t=new r(this.op,this.expr.clone());return t.lineno=this.lineno,t.filename=this.filename,t}}),o.register("nodes/unit.js",function(t,e,n){var a=n("./node"),h=n("./index"),p=t.exports=function(t,e){a.call(this),this.val=t,this.type=e};p.prototype.__proto__=a.prototype,p.prototype.toBoolean=function(){return h.Boolean(!!this.type||this.val)},p.prototype.toString=function(){var t=this.val;return"px"==this.type&&(t=t.toFixed(0)),t+(this.type||"")},p.prototype.clone=function(){var t=new p(this.val,this.type);return t.lineno=this.lineno,t.filename=this.filename,t},p.prototype.operate=function(t,e){var n=this.type||e.type;if("rgba"==e.nodeName||"hsla"==e.nodeName)return e.operate(t,this);if(this.shouldCoerce(t))switch("-"!=t&&"+"!=t||"%"!=e.type?e=this.coerce(e.first):e.val=this.val*(e.val/100),t){case"-":return new p(this.val-e.val,n);case"+":return new p(this.val+e.val,n);case"/":return new p(this.val/e.val,n);case"*":return new p(this.val*e.val,n);case"%":return new p(this.val%e.val,n);case"**":return new p(Math.pow(this.val,e.val),n);case"..":case"...":for(var i=this.val,r=e.val,s=new h.Expression,o=".."==t;s.push(new h.Unit(i)),o?++i<=r:++i<r;);return s}return a.prototype.operate.call(this,t,e)},p.prototype.coerce=function(t){if("unit"!=t.nodeName){if("string"==t.nodeName){var e=parseInt(t.val,10);return isNaN(e)&&a.prototype.coerce.call(this,t),new h.Unit(e)}return a.prototype.coerce.call(this,t)}var n=t;switch(this.type){case"mm":switch(n.type){case"cm":return new h.Unit(2.54*n.val,"mm");case"in":return new h.Unit(25.4*n.val,"mm")}case"cm":switch(n.type){case"mm":return new h.Unit(n.val/10,"cm");case"in":return new h.Unit(2.54*n.val,"cm")}case"in":switch(n.type){case"mm":return new h.Unit(n.val/25.4,"in");case"cm":return new h.Unit(n.val/2.54,"in")}case"ms":switch(n.type){case"s":return new h.Unit(1e3*n.val,"ms")}case"s":switch(n.type){case"ms":return new h.Unit(n.val/1e3,"s")}case"Hz":switch(n.type){case"kHz":return new h.Unit(1e3*n.val,"Hz")}case"kHz":switch(n.type){case"Hz":return new h.Unit(n.val/1e3,"kHz")}default:return new h.Unit(n.val,this.type)}}}),o.register("parser.js",function(t,e,n){var i=n("./lexer"),a=n("./nodes"),r=n("./token"),s=n("./errors"),o=["ident","string","selector","function","comment","boolean","space","color","unit","for","[","]","(",")","+","-","*","*=","<",">","=",":","&","~","{","}"],h=["root","nth-child","nth-last-child","nth-of-type","nth-last-of-type","first-child","last-child","first-of-type","last-of-type","only-child","only-of-type","empty","link","visited","active","hover","focus","target","lang","enabled","disabled","checked","not"],p=t.exports=function(t,e){var n=this;e=e||{},this.lexer=new i(t,e),this.root=e.root||new a.Root,this.state=["root"],this.stash=[],this.parens=0,this.state.pop=function(){n.prevState=[].pop.call(this)}};p.prototype={constructor:p,currentState:function(){return this.state[this.state.length-1]},parse:function(){for(var t=this.parent=this.root;"eos"!=this.peek().type;)if(!this.accept("newline")){var e=this.statement();this.accept(";"),e||this.error("unexpected token {peek}, not allowed at the root level"),t.push(e)}return t},error:function(t){var e=this.peek().type,n=null==this.peek().val?"":" "+this.peek().toString();throw n.trim()==e.trim()&&(n=""),new s.ParseError(t.replace("{peek}",'"'+e+n+'"'))},accept:function(t){if(t==this.peek().type)return this.next()},expect:function(t){return t!=this.peek().type&&this.error('expected "'+t+'", got {peek}'),this.next()},next:function(){var t=this.stash.length?this.stash.pop():this.lexer.next();return a.lineno=t.lineno,t},peek:function(){return this.lexer.peek()},lookahead:function(t){return this.lexer.lookahead(t)},isSelectorToken:function(t){var e=this.lookahead(t).type;switch(e){case"for":return this.bracketed;case"[":return this.bracketed=!0;case"]":return this.bracketed=!1,!0;default:return~o.indexOf(e)}},isPseudoSelector:function(t){return~h.indexOf(this.lookahead(t).val.name)},lineContains:function(t){for(var e,n=1;e=this.lookahead(n++);){if(~["indent","outdent","newline"].indexOf(e.type))return;if(t==e.type)return!0}},selectorToken:function(){if(this.isSelectorToken(1)){if("{"==this.peek().type){if(!this.lineContains("}"))return;for(var t,e=0;(t=this.lookahead(++e))&&"}"!=t.type;)if(":"==t.type)return}return this.next()}},skipWhitespace:function(){for(;~["space","indent","outdent","newline"].indexOf(this.peek().type);)this.next()},skipSpaces:function(){for(;"space"==this.peek().type;)this.next()},looksLikeFunctionDefinition:function(t){return"indent"==this.lookahead(t).type||"{"==this.lookahead(t).type},looksLikeSelector:function(){for(var t,e=1;"ident"==this.lookahead(e).type&&"newline"==this.lookahead(e+1).type;)e+=2;for(;this.isSelectorToken(e)||","==this.lookahead(e).type;){if("selector"==this.lookahead(e).type)return!0;if("{"==this.lookahead(e).type?t=!0:"}"==this.lookahead(e).type&&(t=!1),t&&":"==this.lookahead(e).type)return!0;if("space"==this.lookahead(e).type&&"{"==this.lookahead(e+1).type)return!0;if(":"==this.lookahead(e++).type&&this.isPseudoSelector(e))return!0;if(","==this.lookahead(e).type&&"newline"==this.lookahead(e+1).type)return!0}if(","==this.lookahead(e).type&&"newline"==this.lookahead(e+1).type)return!0;if("{"==this.lookahead(e).type&&"newline"==this.lookahead(e+1).type)return!0;if(this.css&&(";"==this.lookahead(e)||"}"==this.lookahead(e)))return!1;for(;!~["indent","outdent","newline","for","if",";","}"].indexOf(this.lookahead(e).type);)++e;return"indent"==this.lookahead(e).type||void 0},stateAllowsSelector:function(){switch(this.currentState()){case"root":case"selector":case"conditional":case"keyframe":case"function":case"font-face":case"media":case"for":return!0}},statement:function(){var t,e,n=this.stmt(),i=this.prevState;switch(this.allowPostfix&&(delete this.allowPostfix,i="expression"),i){case"assignment":case"expression":case"function arguments":for(;e=this.accept("if")||this.accept("unless")||this.accept("for");)switch(e.type){case"if":case"unless":(n=new a.If(this.expression(),n)).postfix=!0,n.negate="unless"==e.type,this.accept(";");break;case"for":var r,s=this.id().name;this.accept(",")&&(r=this.id().name),this.expect("in");var o=new a.Each(s,r,this.expression());(t=new a.Block).push(n),o.block=t,n=o}}return n},stmt:function(){var t=this.peek().type;switch(t){case"-webkit-keyframes":case"keyframes":return this.keyframes();case"font-face":return this.fontface();case"comment":case"selector":case"literal":case"charset":case"media":case"page":case"ident":case"scope":case"unless":return this[t]();case"function":return this.fun();case"import":return this.atimport();case"if":return this.ifstmt();case"for":return this.forin();case"return":return this.ret();case"{":return this.property();default:if(this.stateAllowsSelector())switch(t){case"color":case"~":case"+":case">":case"<":case":":case"&":case"[":return this.selector();case"*":return this.property();case"-":if("{"==this.lookahead(2).type)return this.property()}var e=this.expression();return e.isEmpty&&this.error("unexpected {peek}"),e}},block:function(t,e){var n,i,r=this.css,s=this.parent=new a.Block(this.parent,t);for(!1===e&&(s.scope=!1),(this.css=this.accept("{"))?(n="}",this.skipWhitespace()):(n="outdent",this.expect("indent"));n!=this.peek().type;){if(this.css){if(this.accept("newline"))continue;i=this.statement(),this.accept(";"),this.skipWhitespace()}else{if(this.accept("newline"))continue;i=this.statement(),this.accept(";")}i||this.error("unexpected token {peek} in block"),s.push(i)}return this.css?(this.skipWhitespace(),this.expect("}"),this.skipSpaces(),this.css=r):this.expect("outdent"),this.parent=s.parent,s},comment:function(){var t=this.next().val;return this.skipSpaces(),t},forin:function(){this.expect("for");var t,e=this.id().name;this.accept(",")&&(t=this.id().name),this.expect("in");var n=new a.Each(e,t,this.expression());return this.state.push("for"),n.block=this.block(n,!1),this.state.pop(),n},ret:function(){this.expect("return");var t=this.expression();return t.isEmpty?new a.Return:new a.Return(t)},unless:function(){this.expect("unless");var t=new a.If(this.expression(),!0);return this.state.push("conditional"),t.block=this.block(t,!1),this.state.pop(),t},ifstmt:function(){this.expect("if");var t=new a.If(this.expression());for(this.state.push("conditional"),t.block=this.block(t,!1);this.accept("else");){if(!this.accept("if")){t.elses.push(this.block(t,!1));break}var e=this.expression(),n=this.block(t,!1);t.elses.push(new a.If(e,n))}return this.state.pop(),t},scope:function(){var t=this.expect("scope").val;return this.selectorScope=t,a.nil},media:function(){var t=this.expect("media").val,e=new a.Media(t);return this.state.push("media"),e.block=this.block(e),this.state.pop(),e},fontface:function(){this.expect("font-face");var t=new a.FontFace;return this.state.push("font-face"),t.block=this.block(t),this.state.pop(),t},atimport:function(){return this.expect("import"),this.allowPostfix=!0,new a.Import(this.expression())},charset:function(){this.expect("charset");var t=this.expect("string").val;return this.allowPostfix=!0,new a.Charset(t)},page:function(){var t;if(this.expect("page"),this.accept(":")){var e=this.expect("ident").val.name;t=new a.Literal(":"+e)}var n=new a.Page(t);return this.state.push("page"),n.block=this.block(n),this.state.pop(),n},keyframes:function(){var t,e=this.css,n=this.expect("keyframes"),i=new a.Keyframes(this.id(),n.val);for((this.css=this.accept("{"))?this.skipWhitespace():this.expect("indent");t=this.accept("unit")||this.accept("ident");){if("ident"==t.type)switch(this.accept("space"),t.val.name){case"from":t=new a.Unit(0,"%");break;case"to":t=new a.Unit(100,"%");break;default:this.error('"'+t.val.name+'" is invalid, use "from" or "to"')}else t=t.val;this.state.push("keyframe");var r=this.block(i);i.push(t,r),this.state.pop(),this.css&&this.skipWhitespace()}return this.css?(this.skipWhitespace(),this.expect("}"),this.css=e):this.expect("outdent"),i},literal:function(){return this.expect("literal").val},id:function(){var t=this.expect("ident");return this.accept("space"),t.val},ident:function(){for(var t=2,e=this.lookahead(t).type;"space"==e;)e=this.lookahead(++t).type;switch(e){case"=":case"?=":case"-=":case"+=":case"*=":case"/=":case"%=":return this.assignment();case"[":if(this._ident==this.peek())return this.id();for(;"]"!=this.lookahead(t++).type&&"selector"!=this.lookahead(t).type;);if("="==this.lookahead(t).type)return this._ident=this.peek(),this.expression();if(this.looksLikeSelector()&&this.stateAllowsSelector())return this.selector();case"-":case"+":case"/":case"*":case"%":case"**":case"and":case"or":case"&&":case"||":case">":case"<":case">=":case"<=":case"!=":case"==":case"?":case"in":case"is a":case"is defined":if(this._ident==this.peek())return this.id();switch(this._ident=this.peek(),this.currentState()){case"for":case"selector":return this.property();case"root":case"media":case"font-face":return this.selector();default:return this.operand?this.id():this.expression()}default:switch(this.currentState()){case"root":return this.selector();case"for":case"page":case"media":case"font-face":case"selector":case"function":case"keyframe":case"conditional":return this.property();default:return this.id()}}},interpolate:function(){var t,e=[];for(this.accept("*")&&e.push(new a.Literal("*"));;)if(this.accept("{"))this.state.push("interpolation"),e.push(this.expression()),this.expect("}"),this.state.pop();else if(t=this.accept("-"))e.push(new a.Literal("-"));else{if(!(t=this.accept("ident")))break;e.push(t.val)}return e.length||this.expect("ident"),e},property:function(){if(this.looksLikeSelector())return this.selector();var t=this.interpolate(),e=prop=new a.Property(t);return this.accept("space"),this.accept(":")&&this.accept("space"),this.state.push("property"),this.inProperty=!0,prop.expr=this.list(),prop.expr.isEmpty&&(e=t[0]),this.inProperty=!1,this.allowPostfix=!0,this.state.pop(),this.accept(";"),e},selector:function(){var t,e,n=new a.Group,i=this.selectorScope,r="root"==this.currentState();do{for(e=[],this.accept("newline");t=this.selectorToken();)switch(t.type){case"{":this.skipSpaces();var s=this.expression();this.skipSpaces(),this.expect("}"),e.push(s);break;case"comment":e.push(new a.Literal(t.val.str));break;case"color":e.push(new a.Literal(t.val.raw));break;case"space":e.push(new a.Literal(" "));break;case"function":e.push(new a.Literal(t.val.name+"("));break;case"ident":e.push(new a.Literal(t.val.name));break;default:e.push(new a.Literal(t.val)),t.space&&e.push(new a.Literal(" "))}r&&i&&e.unshift(new a.Literal(i+" ")),n.push(new a.Selector(e))}while(this.accept(",")||this.accept("newline"));return this.lexer.allowComments=!1,this.state.push("selector"),n.block=this.block(n),this.state.pop(),n},assignment:function(){var t,e,n=this.id().name;if(t=this.accept("=")||this.accept("?=")||this.accept("+=")||this.accept("-=")||this.accept("*=")||this.accept("/=")||this.accept("%=")){this.state.push("assignment");var i=this.list();switch(i.isEmpty&&this.error("invalid right-hand side operand in assignment, got {peek}"),e=new a.Ident(n,i),this.state.pop(),t.type){case"?=":var r=new a.BinOp("is defined",e),s=new a.Ident(n);e=new a.Ternary(r,s,e);break;case"+=":case"-=":case"*=":case"/=":case"%=":e.val=new a.BinOp(t.type[0],new a.Ident(n),i)}}return e},fun:function(){var t,e=1,n=2;t:for(;t=this.lookahead(n++);)switch(t.type){case"function":case"(":++e;break;case")":if(!--e)break t;break;case"eos":this.error('failed to find closing paren ")"')}switch(this.currentState()){case"expression":return this.functionCall();default:return this.looksLikeFunctionDefinition(n)?this.functionDefinition():this.expression()}},url:function(){this.expect("function"),this.state.push("function arguments");var t=this.args();return this.expect(")"),this.state.pop(),new a.Call("url",t)},functionCall:function(){if("url"==this.peek().val.name)return this.url();var t=this.expect("function").val.name;this.state.push("function arguments");var e=this.args();return this.expect(")"),this.state.pop(),new a.Call(t,e)},functionDefinition:function(){var t=this.expect("function").val.name;this.state.push("function params"),this.skipWhitespace();var e=this.params();this.skipWhitespace(),this.expect(")"),this.state.pop(),this.state.push("function");var n=new a.Function(t,e);return n.block=this.block(n),this.state.pop(),new a.Ident(t,n)},params:function(){for(var t,e,n=new a.Params;t=this.accept("ident");)this.accept("space"),n.push(e=t.val),this.accept("...")?e.rest=!0:this.accept("=")&&(e.val=this.expression()),this.skipWhitespace(),this.accept(","),this.skipWhitespace();return n},args:function(){for(var t,e=new a.Arguments;"ident"==this.peek().type&&":"==this.lookahead(2).type?(t=this.next().val.string,this.expect(":"),e.map[t]=this.expression()):e.push(this.expression()),this.accept(","););return e},list:function(){for(var t=this.expression();this.accept(",");)if(t.isList)e.push(this.expression());else{var e=new a.Expression(!0);e.push(t),e.push(this.expression()),t=e}return t},expression:function(){var t,e=new a.Expression;for(this.state.push("expression");t=this.negation();)t||this.error("unexpected token {peek} in expression"),e.push(t);return this.state.pop(),e},negation:function(){return this.accept("not")?new a.UnaryOp("!",this.negation()):this.ternary()},ternary:function(){var t=this.logical();if(this.accept("?")){var e=this.expression();this.expect(":");var n=this.expression();t=new a.Ternary(t,e,n)}return t},logical:function(){for(var t,e=this.typecheck();t=this.accept("&&")||this.accept("||");)e=new a.BinOp(t.type,e,this.typecheck());return e},typecheck:function(){for(var t,e=this.equality();t=this.accept("is a");)this.operand=!0,e||this.error('illegal unary "'+t+'", missing left-hand operand'),e=new a.BinOp(t.type,e,this.equality()),this.operand=!1;return e},equality:function(){for(var t,e=this.inop();t=this.accept("==")||this.accept("!=");)this.operand=!0,e||this.error('illegal unary "'+t+'", missing left-hand operand'),e=new a.BinOp(t.type,e,this.inop()),this.operand=!1;return e},inop:function(){for(var t=this.relational();this.accept("in");)this.operand=!0,t||this.error('illegal unary "in", missing left-hand operand'),t=new a.BinOp("in",t,this.relational()),this.operand=!1;return t},relational:function(){for(var t,e=this.range();t=this.accept(">=")||this.accept("<=")||this.accept("<")||this.accept(">");)this.operand=!0,e||this.error('illegal unary "'+t+'", missing left-hand operand'),e=new a.BinOp(t.type,e,this.range()),this.operand=!1;return e},range:function(){var t,e=this.additive();return(t=this.accept("...")||this.accept(".."))&&(this.operand=!0,e||this.error('illegal unary "'+t+'", missing left-hand operand'),e=new a.BinOp(t.val,e,this.additive()),this.operand=!1),e},additive:function(){for(var t,e=this.multiplicative();t=this.accept("+")||this.accept("-");)this.operand=!0,e=new a.BinOp(t.type,e,this.multiplicative()),this.operand=!1;return e},multiplicative:function(){for(var t,e=this.defined();t=this.accept("**")||this.accept("*")||this.accept("/")||this.accept("%");){if(this.operand=!0,"/"==t&&this.inProperty&&!this.parens)return this.stash.push(new r("literal",new a.Literal("/"))),this.operand=!1,e;e||this.error('illegal unary "'+t+'", missing left-hand operand'),e=new a.BinOp(t.type,e,this.defined()),this.operand=!1}return e},defined:function(){var t=this.unary();return this.accept("is defined")&&(t||this.error('illegal unary "is defined", missing left-hand operand'),t=new a.BinOp("is defined",t)),t},unary:function(){var t,e;return(t=this.accept("!")||this.accept("~")||this.accept("+")||this.accept("-"))?(this.operand=!0,e=new a.UnaryOp(t.type,this.unary()),this.operand=!1,e):this.subscript()},subscript:function(){for(var t=this.primary();this.accept("[");)t=new a.BinOp("[]",t,this.expression()),this.expect("]"),this.accept("=")&&(t.op+="=",t.val=this.expression());return t},primary:function(){if(this.accept("(")){++this.parens;var t=this.expression();return this.expect(")"),--this.parens,t}switch(this.peek().type){case"null":case"unit":case"color":case"string":case"literal":case"boolean":return this.next().val;case"ident":return this.ident();case"function":return this.functionCall()}}}}),o.register("renderer.js",function(t,e,n){var r=n("./parser"),s=n("./visitor/compiler"),o=n("./visitor/evaluator"),a=(n("./utils"),n("./nodes")),i=(n("./path").join,t.exports=function(t,e){(e=e||{}).globals={},e.functions={},e.imports=[],e.paths=e.paths||[],e.filename=e.filename||"stylus",this.options=e,this.str=t});i.prototype.render=function(e){var t=this.parser=new r(this.str,this.options);try{a.filename=this.options.filename;var n=t.parse();this.evaluator=new o(n,this.options),n=this.evaluator.evaluate();var i=new s(n,this.options);e(null,i.compile(),i.js)}catch(t){e(t)}},i.prototype.set=function(t,e){return this.options[t]=e,this},i.prototype.get=function(t){return this.options[t]},i.prototype.include=function(t){return this.options.paths.push(t),this},i.prototype.use=function(t){return t.call(this,this),this},i.prototype.define=function(t,e,n){return e.nodeName?this.options.globals[t]=e:(this.options.functions[t]=e,null!=n&&(e.raw=n)),this}}),o.register("stack/index.js",function(t,e,n){n("./frame");var i=t.exports=function(){Array.apply(this,arguments)};i.prototype.__proto__=Array.prototype,i.prototype.push=function(t){return t.stack=this,t.parent=this.currentFrame,[].push.apply(this,arguments)},i.prototype.__defineGetter__("currentFrame",function(){return this[this.length-1]}),i.prototype.getBlockFrame=function(t){for(var e=0;e<this.length;++e)if(t==this[e].block)return this[e]},i.prototype.lookup=function(t){var e,n=this.currentFrame.block;do{var i=this.getBlockFrame(n);if(i&&(e=i.lookup(t)))switch(e.first.nodeName){case"ident":return this.lookup(e.first.name)||e;default:return e}}while(n=n.parent)},i.prototype.inspect=function(){return this.reverse().map(function(t){return t.inspect()}).join("\n")},i.prototype.toString=function(){for(var t,e,n=[],i=this.length;i--;)if(t=this[i].block.node)switch(e="("+t.filename+":"+(t.lineno+1)+")",t.nodeName){case"function":n.push("    at "+t.name+"() "+e);break;case"group":n.push('    at "'+t.nodes[0].val+'" '+e)}return n.join("\n")}}),o.register("stack/frame.js",function(t,e,n){var i=n("./scope"),r=(n("../nodes"),t.exports=function(t){this._scope=!1===t.scope?null:new i,this.block=t});r.prototype.__defineGetter__("scope",function(){return this._scope||this.parent.scope}),r.prototype.lookup=function(t){return this.scope.lookup(t)},r.prototype.inspect=function(){return"[Frame "+(!1===this.block.scope?"scope-less":this.scope.inspect())+"]"}}),o.register("stack/scope.js",function(t,e,n){var i=t.exports=function(){this.locals={}};i.prototype.add=function(t){this.locals[t.name]=t.val},i.prototype.lookup=function(t){return this.locals[t]},i.prototype.inspect=function(){var t=Object.keys(this.locals).map(function(t){return"@"+t});return"[Scope"+(t.length?" "+t.join(", "):"")+"]"}}),o.register("stylus.js",function(t,e,n){var i=n("./renderer"),r=(n("./parser"),n("./nodes"));n("./utils");(e=t.exports=function(t,e){return new i(t=bifs+t,e)}).version="0.16.0",e.nodes=r,e.functions=n("./functions"),e.utils=n("./utils"),e.Visitor=n("./visitor"),e.Parser=n("./parser"),e.Evaluator=n("./visitor/evaluator"),e.render=function(t,e,n){"function"==typeof e&&(n=e,e={}),new i(t,e).render(n)},e.url=n("./functions/url")}),o.register("token.js",function(t,e,n){var i=t.exports=function(t,e){this.type=t,this.val=e};i.prototype.inspect=function(){var t=" "+this.val;return"[Token:"+this.lineno+" [32m"+this.type+"[0m[33m"+(this.val?t:"")+"[0m]"},i.prototype.toString=function(){return(void 0===this.val?this.type:this.val).toString()}}),o.register("utils.js",function(t,s,e){e("./nodes");var o=e("./path").join;s.absolute=function(t){return/^([a-z]:\\)|\//i.test(t)},s.lookup=function(t,e,n){var i,r=e.length;if(s.absolute(t))try{return t}catch(t){}for(;r--;)try{if(n==(i=o(e[r],t)))continue;return i}catch(t){}},s.formatException=function(t,e){var i=e.lineno,n=e.filename,r=e.input,s=(s=e.context||8)/2,o=("\n"+r).split("\n"),a=Math.max(i-s,1),h=Math.min(o.length,i+s),p=h.toString().length;s=o.slice(a,h).map(function(t,e){var n=e+a;return(n==i?" > ":"   ")+Array(p-n.toString().length+1).join(" ")+n+"| "+t}).join("\n");return t.message=n+":"+i+"\n"+s+"\n\n"+t.message+"\n"+(t.stylusStack?t.stylusStack+"\n":""),t},s.assertType=function(t,e,n){if(s.assertPresent(t,n),t.nodeName!=e){var i=t.nodeName;throw new Error("TypeError: "+('expected "'+n+'" to be a '+e+", but got "+i+":"+t))}},s.assertString=function(t,e){switch(s.assertPresent(t,e),t.nodeName){case"string":case"ident":case"literal":return;default:var n=t.nodeName;throw new Error("TypeError: "+("expected string, ident or literal, but got "+n+":"+t))}},s.assertColor=function(t,e){switch(s.assertPresent(t,e),t.nodeName){case"rgba":case"hsla":return;default:var n=t.nodeName;throw new Error("TypeError: "+("expected rgba or hsla, but got "+n+":"+t))}},s.assertPresent=function(t,e){if(!t)throw e?new Error('"'+e+'" argument required'):new Error("argument missing")},s.unwrap=function(t){return t.preserve?t:"arguments"!=t.nodeName&&"expression"!=t.nodeName?t:1!=t.nodes.length?t:"arguments"!=t.nodes[0].nodeName&&"expression"!=t.nodes[0].nodeName?t:s.unwrap(t.nodes[0])},s.params=function(t){return t.toString().match(/\(([^)]*)\)/)[1].split(/ *, */)},s.merge=function(t,e){for(var n in e)t[n]=e[n];return t}}),o.register("visitor/index.js",function(t,e,n){(t.exports=function(t){this.root=t}).prototype.visit=function(t,e){var n="visit"+t.constructor.name;return this[n]?this[n](t):t}}),o.register("visitor/compiler.js",function(t,e,n){var i=n("./index"),r=(n("../nodes"),t.exports=function(t,e){e=e||{},this.compress=e.compress,this.firebug=e.firebug,this.linenos=e.linenos,this.indents=1,i.call(this,t),this.tree=[],this.js=""});r.prototype.__proto__=i.prototype,r.prototype.compile=function(){return this.visit(this.root)},r.prototype.__defineGetter__("indent",function(){return this.compress?"":new Array(this.indents).join("  ")}),r.prototype.visitRoot=function(t){this.buf="";for(var e=0,n=t.nodes.length;e<n;++e){var i=t.nodes[e];switch(i.nodeName){case"null":case"expression":case"function":case"jsliteral":case"unit":continue;default:var r=this.visit(i);r&&(this.buf+=r+"\n")}}return this.buf},r.prototype.visitBlock=function(t){var e;if(t.hasProperties){var n=[this.compress?"{":" {"];++this.indents;for(var i=0,r=t.nodes.length;i<r;++i)switch(this.last=r-1==i,(e=t.nodes[i]).nodeName){case"null":case"expression":case"function":case"jsliteral":case"group":case"unit":continue;default:n.push(this.visit(e))}--this.indents,n.push(this.indent+"}"),this.buf+=n.join(this.compress?"":"\n"),this.buf+="\n"}for(i=0,r=t.nodes.length;i<r;++i)switch((e=t.nodes[i]).nodeName){case"group":case"print":case"page":case"block":case"keyframes":(this.linenos||this.firebug)&&this.debugInfo(e),this.visit(e);break;case"media":case"import":case"fontface":this.visit(e)}},r.prototype.visitKeyframes=function(t){var e="official"==t.prefix?"":"-"+t.prefix+"-";this.buf+="@"+e+"keyframes "+this.visit(t.name)+(this.compress?"{":" {"),++this.indents,t.frames.forEach(function(t){this.compress||(this.buf+="\n  "),this.buf+=this.visit(t.pos),this.visit(t.block)},this),--this.indents,this.buf+="}"+(this.compress?"":"\n")},r.prototype.visitMedia=function(t){this.buf+="@media "+t.val,this.buf+=this.compress?"{":" {\n",++this.indents,this.visit(t.block),--this.indents,this.buf+="}"+(this.compress?"":"\n")},r.prototype.visitPage=function(t){this.buf+=this.indent+"@page",this.buf+=t.selector?" "+t.selector:"",this.visit(t.block)},r.prototype.visitImport=function(t){this.buf+="@import "+this.visit(t.path)+";\n"},r.prototype.visitFontFace=function(t){this.buf+=this.indent+"@font-face",this.visit(t.block)},r.prototype.visitJSLiteral=function(t){return this.js+="\n"+t.val.replace(/@selector/g,'"'+this.selector+'"'),""},r.prototype.visitComment=function(t){return this.compress&&t.suppress?"":t.str},r.prototype.visitFunction=function(t){return t.name},r.prototype.visitVariable=function(t){return""},r.prototype.visitCharset=function(t){return"@charset "+this.visit(t.val)+";"},r.prototype.visitLiteral=function(t){return t.val.trim().replace(/^  /gm,"")},r.prototype.visitBoolean=function(t){return t.toString()},r.prototype.visitRGBA=function(t){return t.toString()},r.prototype.visitHSLA=function(t){return t.rgba.toString()},r.prototype.visitUnit=function(t){var e=t.type||"",n=t.val,i=n!=(0|n);if(this.compress){if("%"!=e&&0==n)return"0";if(i&&n<1&&-1<n)return n.toString().replace("0.",".")+e}return n.toString()+e},r.prototype.visitGroup=function(t){var r=this,e=this.tree,n=(e[e.length-1],[]);t.nodes.forEach(function(t){n.push(t.parent?t:t.val)}),e.push(n);var s=[],o=[];t.block.hasProperties&&(function e(n,i){i?n[i].forEach(function(t){o.unshift(t),e(n,i-1),o.shift()}):n[0].forEach(function(t){var e=t.trim();if(o.length)for(var n=0,i=o.length;n<i;++n)~o[n].indexOf("&")?e=o[n].replace(/&/g,e).trim():e+=" "+o[n].trim();s.push(r.indent+e.trimRight())})}(e,e.length-1),this.buf+=this.selector=s.join(this.compress?",":",\n")),this.visit(t.block),e.pop()},r.prototype.visitIdent=function(t){return t.name},r.prototype.visitString=function(t){return this.isURL?t.val:t.toString()},r.prototype.visitNull=function(t){return""},r.prototype.visitCall=function(t){this.isURL="url"==t.name;var e=t.args.nodes.map(function(t){return this.visit(t)},this).join(this.compress?",":", ");return this.isURL&&(e='"'+e+'"'),delete this.isURL,t.name+"("+e+")"},r.prototype.visitExpression=function(i){var r=[],s=this,o=i.nodes.length,a=i.nodes.map(function(t){return s.visit(t)});return a.forEach(function(t,e){var n=e==o-1;r.push(t),"/"!=a[e+1]&&"/"!=t&&(n||r.push(i.isList?s.compress?",":", ":s.isURL?"":" "))}),r.join("")},r.prototype.visitArguments=r.prototype.visitExpression,r.prototype.visitProperty=function(t){var e=this.visit(t.expr);return this.indent+(t.name||t.segments.join(""))+(this.compress?":"+e:": "+e)+(this.compress&&this.last?"":";")}}),o.register("visitor/evaluator.js",function(t,e,c){var n=c("./index"),u=c("../nodes"),i=c("../stack"),p=c("../stack/frame"),l=(c("../stack/scope"),c("../utils")),r=c("../functions"),f=c("../path").dirname,d=c("../path").join,s=c("../colors"),o=t.exports=function(t,e){e=e||{},n.call(this,t),this.stack=new i,this.imports=e.imports||[],this.functions=e.functions||{},this.globals=e.globals||{},this.paths=e.paths||[],this.filename=e.filename,this.paths.push(f(e.filename||".")),this.stack.push(this.global=new p(t)),this.warnings=e.warn,this.options=e,this.calling=[],this.importStack=[]};o.prototype.__proto__=n.prototype;var a=n.prototype.visit;o.prototype.visit=function(e){try{return a.call(this,e)}catch(t){if(t.filename)throw t;throw t.lineno=e.lineno,t.filename=e.filename,t.stylusStack=this.stack.toString(),t}},o.prototype.setup=function(){this.populateGlobalScope(),this.imports.forEach(function(t){var e=new u.Expression;e.push(new u.String(t)),this.visit(new u.Import(e))},this)},o.prototype.populateGlobalScope=function(){var r=this.global.scope;Object.keys(s).forEach(function(t){var e=s[t],n=new u.RGBA(e[0],e[1],e[2],1),i=new u.Ident(t,n);r.add(i)});var e=this.globals;Object.keys(e).forEach(function(t){r.add(new u.Ident(t,e[t]))})},o.prototype.evaluate=function(){return this.setup(),this.visit(this.root)},o.prototype.visitGroup=function(t){this.vendors;return t.nodes=t.nodes.map(function(t){return t.val=this.interpolate(t),t},this),t.block=this.visit(t.block),t},o.prototype.visitCharset=function(t){return t},o.prototype.visitReturn=function(t){throw t.expr=this.visit(t.expr),t},o.prototype.visitMedia=function(t){return t.block=this.visit(t.block),t},o.prototype.visitKeyframes=function(n){return n.fabricated?n:(n.name=this.visit(n.name).first.name,n.frames=n.frames.map(function(t){return t.block=this.visit(t.block),t},this),"official"!=n.prefix?n:(this.vendors.forEach(function(t){var e=n.clone();e.prefix=t,e.fabricated=!0,this.currentBlock.push(e)},this),u.nil))},o.prototype.visitFunction=function(t){var e=this.stack.currentFrame.scope.lookup(t.name);return e&&this.warn("local "+e.nodeName+' "'+t.name+'" previously defined in this scope'),this.functions[t.name]&&this.warn('user-defined function "'+t.name+'" is already defined'),r[t.name]&&this.warn('built-in function "'+t.name+'" is already defined'),t},o.prototype.visitEach=function(t){var e,n=l.unwrap(this.visit(l.unwrap(t.expr))),i=n.nodes.length,r=new u.Ident(t.val),s=new u.Ident(t.key||"__index__"),o=this.currentScope,a=this.currentBlock,h=[];t.block.scope=!1;for(var p=0;p<i;++p)r.val=n.nodes[p],s.val=new u.Unit(p),o.add(r),o.add(s),e=this.visit(t.block.clone()),h=h.concat(e.nodes);return this.mixin(h,a),h[h.length-1]||u.nil},o.prototype.visitCall=function(t){var e=this.lookup(t.name);if(this.ignoreColors="url"==t.name,e&&"expression"==e.nodeName&&(e=e.nodes[0]),e&&"function"!=e.nodeName&&(e=this.lookupFunction(t.name)),!e||"function"!=e.nodeName){var n=this.literalCall(t);return this.ignoreColors=!1,n}if(this.calling.push(t.name),200<this.calling.length)throw new RangeError("Maximum call stack size exceeded");"expression"==e.nodeName&&(e=e.first);var i=this.ret;this.ret=!0;var r=this.visit(t.args);for(var s in t.args.map)t.args.map[s]=this.visit(t.args.map[s]);return this.ret=i,e.fn?n=this.invokeBuiltin(e.fn,r):"function"==e.nodeName&&(n=this.invokeFunction(e,r)),this.calling.pop(),this.ignoreColors=!1,n},o.prototype.visitIdent=function(t){var e;if(t.property)return(e=this.lookupProperty(t.name))?this.visit(e.expr.clone()):u.nil;if(t.val.isNull){var n=this.lookup(t.name);return n?this.visit(n):t}var i=this.ret;return this.ret=!0,t.val=this.visit(t.val),this.ret=i,this.currentScope.add(t),t.val},o.prototype.visitBinOp=function(t){if("is defined"==t.op)return this.isDefined(t.left);var e=this.ret;this.ret=!0;var n=t.op,i=this.visit(t.left),r=this.visit(t.right);this.ret=e;var s=t.val?this.visit(t.val):null;try{return this.visit(i.operate(n,r,s))}catch(t){if("CoercionError"==t.name)switch(n){case"==":return u.no;case"!=":return u.yes}throw t}},o.prototype.visitUnaryOp=function(t){var e=t.op,n=this.visit(t.expr);switch("!"!=e&&(n=n.first.clone(),l.assertType(n,"unit")),e){case"-":n.val=-n.val;break;case"+":n.val=+n.val;break;case"~":n.val=~n.val;break;case"!":return n.toBoolean().negate()}return n},o.prototype.visitTernary=function(t){return this.visit(t.cond).toBoolean().isTrue?this.visit(t.trueExpr):this.visit(t.falseExpr)},o.prototype.visitExpression=function(t){for(var e=0,n=t.nodes.length;e<n;++e)t.nodes[e]=this.visit(t.nodes[e]);return t},o.prototype.visitArguments=o.prototype.visitExpression,o.prototype.visitProperty=function(t){var e=this.interpolate(t),n=this.lookup(e),i=n&&"function"==n.nodeName,r=~this.calling.indexOf(e);if(i&&!r&&!t.literal){this.calling.push(e);var s=u.Arguments.fromExpression(l.unwrap(t.expr)),o=this.visit(new u.Call(e,s));return this.calling.pop(),o}var a=this.ret;return this.ret=!0,t.name=e,t.literal=!0,(this.property=t).expr=this.visit(t.expr),delete this.property,this.ret=a,t},o.prototype.visitRoot=function(t){for(var e=0;e<t.nodes.length;++e)t.index=this.rootIndex=e,t.nodes[e]=this.visit(t.nodes[e]);return t},o.prototype.visitBlock=function(e){for(this.stack.push(new p(e)),e.index=0;e.index<e.nodes.length;++e.index)try{e.nodes[e.index]=this.visit(e.nodes[e.index])}catch(t){if("return"==t.nodeName){if(this.ret)throw this.stack.pop(),t;e.nodes[e.index]=t;break}throw t}return this.stack.pop(),e},o.prototype.visitIf=function(t){var e,n=this.ret,i=this.currentBlock,r=t.negate;this.ret=!0;var s=this.visit(t.cond).first.toBoolean();if(this.ret=n,r)s.isFalse&&(e=this.visit(t.block));else if(s.isTrue)e=this.visit(t.block);else if(t.elses.length)for(var o=t.elses,a=o.length,h=0;h<a;++h)if(o[h].cond){if(this.visit(o[h].cond).first.toBoolean().isTrue){e=this.visit(o[h].block);break}}else e=this.visit(o[h]);return e&&!t.postfix&&i.node&&"group"==i.node.nodeName?(this.mixin(e.nodes,i),u.nil):e||u.nil},o.prototype.visitImport=function(n){var e,t=this.root,i=c("../parser"),r=this.visit(n.path).first;if("url"==r.name)return n;if(!r.string)throw new Error("@import string expected");var s=r=r.string;if(~r.indexOf(".css"))return n;if(~r.indexOf(".styl")||(r+=".styl"),e=(e=l.lookup(r,this.paths,this.filename))||l.lookup(d(s,"index.styl"),this.paths,this.filename),n.path=e,n.dirname=f(e),this.paths.push(n.dirname),this.options._imports&&this.options._imports.push(n),!e)throw new Error("failed to locate @import file "+r);this.importStack.push(e),u.filename=e;var o=fs.readFileSync(e,"utf8"),a=new u.Block,h=new i(o,l.merge({root:a},this.options));try{a=h.parse()}catch(t){throw t.filename=e,t.lineno=h.lexer.lineno,t.input=o,t}fs.stat(e,function(t,e){t||(n.mtime=e.mtime)}),a.parent=t,a.scope=!1;var p=this.visit(a);return this.paths.pop(),this.importStack.pop(),p},o.prototype.invokeFunction=function(n,i){var t=new u.Block(n.block.parent);n.block.parent=t;var e=n.block.clone(),r=this.stack.currentFrame.block;this.stack.push(new p(t));var s=this.currentScope;if(s.add(new u.Ident("arguments",i)),s.add(new u.Ident("mixin",this.ret?u.no:new u.String(r.nodeName))),this.property){var o=this.propertyExpression(this.property,n.name);s.add(new u.Ident("current-property",o))}else s.add(new u.Ident("current-property",u.nil));var a=0,h=i.nodes.length;return n.params.nodes.forEach(function(t){if(t.rest){for(t.val=new u.Expression;a<h;++a)t.val.push(i.nodes[a]);t.val.preserve=!0}else{var e=i.map[t.name]||i.nodes[a++];if(t=t.clone(),e?e.isEmpty||(t.val=e):i.push(t.val),t.val.isNull)throw new Error('argument "'+t+'" required for '+n)}s.add(t)}),this.invoke(e,!0)},o.prototype.invokeBuiltin=function(t,i){i=t.raw?i.nodes:l.params(t).reduce(function(t,e){var n=i.map[e]||i.nodes.shift();return n&&t.push(n.first),t},[]);var e=t.apply(this,i),n=new u.Expression;return n.push(e),e=n,this.invoke(e)},o.prototype.invoke=function(t,e){var n;if(this.ret)n=this.eval(t.nodes),e&&this.stack.pop();else{var i=this.stack[this.stack.length-2];i&&(this.targetBlock=i.block),t=this.visit(t),e&&this.stack.pop(),this.mixin(t.nodes,this.currentBlock),n=u.nil}return n},o.prototype.mixin=function(t,e){var n=e.nodes.length,i=e.nodes.slice(0,e.index),r=e.nodes.slice(e.index+1,n);this._mixin(t,i),e.nodes=i.concat(r)},o.prototype._mixin=function(t,e){for(var n,i=t.length,r=0;r<i;++r)switch((n=t[r]).nodeName){case"return":return;case"block":this._mixin(n.nodes,e);break;default:e.push(n)}},o.prototype.eval=function(t){if(!t)return u.nil;var e=t.length,n=u.nil;try{for(var i=0;i<e;++i)switch((n=t[i]).nodeName){case"if":if("block"!=n.block.nodeName){n=this.visit(n);break}case"each":case"block":(n=this.visit(n)).nodes&&(n=this.eval(n.nodes));break;default:n=this.visit(n)}}catch(t){if("return"==t.nodeName)return t.expr;throw t}return n},o.prototype.literalCall=function(t){return t.args=this.visit(t.args),t},o.prototype.lookupProperty=function(t){for(var e=this.closestBlock.nodes,n=0,i=(e=(this.targetBlock&&this.targetBlock.nodes||[]).concat(e)).length;n<i;++n)if("property"==e[n].nodeName&&t==this.interpolate(e[n]))return e[n].clone()},o.prototype.lookup=function(t){var e;if(!(this.ignoreColors&&t in s))return(e=this.stack.lookup(t))?l.unwrap(e):this.lookupFunction(t)},o.prototype.interpolate=function(t){var r=this;return t.segments.map(function(t){return function t(e){switch(e.nodeName){case"function":case"ident":return e.name;case"literal":case"string":case"unit":return e.val;case"expression":var n=r.ret;r.ret=!0;var i=t(r.visit(e).first);return r.ret=n,i}}(t)}).join("")},o.prototype.lookupFunction=function(t){var e=this.functions[t]||r[t];if(e)return new u.Function(t,e)},o.prototype.isDefined=function(t){if("ident"==t.nodeName)return u.Boolean(this.lookup(t.name));throw new Error('invalid "is defined" check on non-variable '+t)},o.prototype.propertyExpression=function(t,e){var n=new u.Expression,i=t.expr.clone();return n.push(new u.String(t.name)),i.nodes=i.nodes.map(function(t){return"call"==t.nodeName&&e==t.name?new u.Literal("__CALL__"):t}),n.push(i),n},o.prototype.warn=function(t){this.warnings&&console.warn("[33mWarning:[0m "+t)},o.prototype.__defineGetter__("currentBlock",function(){return this.stack.currentFrame.block}),o.prototype.__defineGetter__("closestBlock",function(){for(var t,e=this.stack.length;e--;)if((t=this.stack[e].block).node)switch(t.node.nodeName){case"group":case"function":return t}}),o.prototype.__defineGetter__("vendors",function(){return[]}),o.prototype.__defineGetter__("currentScope",function(){return this.stack.currentFrame.scope}),o.prototype.__defineGetter__("currentFrame",function(){return this.stack.currentFrame})}),o("stylus")}();